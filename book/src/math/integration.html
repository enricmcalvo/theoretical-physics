<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Integration &mdash; Theoretical Physics Reference v0.1 documentation</title>
    <link rel="stylesheet" href="../../static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../static/jquery.js"></script>
    <script type="text/javascript" src="../../static/doctools.js"></script>
    <link rel="top" title="Theoretical Physics Reference v0.1 documentation" href="../../index.html" />
    <link rel="next" title="Residue Theorem" href="residue.html" />
    <link rel="prev" title="Theoretical Physics Reference" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="residue.html" title="Residue Theorem"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Theoretical Physics Reference"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Theoretical Physics Reference v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="integration">
<span id="index-84"></span><h1>Integration<a class="headerlink" href="#integration" title="Permalink to this headline">¶</a></h1>
<p>This chapter doesn&#8217;t assume any knowledge about differential geometry. The most
versatile way to do integration over manifolds is explained in the differential
geometry section.</p>
<div class="section" id="general-case">
<h2>General Case<a class="headerlink" href="#general-case" title="Permalink to this headline">¶</a></h2>
<p>We want to integrate a function <img class="math" src="../../images/math/bb2c93730dbb48558bb3c4738c956c4e8f816437.png" alt="f"/> over a <img class="math" src="../../images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>-manifold in <img class="math" src="../../images/math/5f1a7b76db27e141b76722911bbb568cb785751d.png" alt="\R^n"/>, parametrized
as:</p>
<div class="math">
<p><img src="../../images/math/7f3ae765437552e8dd8b23f9104e7a22df21103a.png" alt="\mathbf{\varphi}: \R^k \to \R^n\quad \mathbf{\varphi}(t_1, t_2, \dots, t_k) =
\mat{\varphi_1(t_1, t_2, \dots, t_k)\cr
    \varphi_2(t_1, t_2, \dots, t_k)\cr
    \vdots \cr
    \varphi_n(t_1, t_2, \dots, t_k)\cr
}" /></p>
</div><p>then the integral of <img class="math" src="../../images/math/503728b47daf13610fcee386d9596af1eca39e97.png" alt="f(x_1, x_2, \dots, x_n)"/> over <img class="math" src="../../images/math/921aade3100afbc11d0d13f71cdd7e68d83ad52e.png" alt="\varphi"/> is:</p>
<div class="math">
<p><img src="../../images/math/570ea37a7211d7b21fe98c4acb233bf4d051402e.png" alt="\int_M f(x_1, x_2, \dots, x_n)\,\d S = \int_{\R^n} f(\mathbf{\varphi}(t_1,
t_2, \dots, t_k))\sqrt{\det{\bf G}}\,\d t_1\d t_2\cdots\d t_k" /></p>
</div><p>where <img class="math" src="../../images/math/716c649fcc570e4ec644a64b6746649c118f0bc2.png" alt="{\bf G}"/> is called a Gram matrix and <img class="math" src="../../images/math/acf8b78bcf615f4ed1ad4e04d91f077d86a0d1e9.png" alt="{\bf J}"/> is a Jacobian:</p>
<div class="math">
<p><img src="../../images/math/5ead551abca855ed2548698fd00b7d1673a8ab68.png" alt="({\bf G})_{ij} = ({\bf J}^T{\bf J})_{ij} = J_{ik}J_{kj} =
{\partial\varphi_k\over\partial t_i} {\partial\varphi_k\over\partial t_j}

({\bf J})_{ij} = {\partial\varphi_i\over\partial t_j} = \mat{
    {\partial\mathbf{\varphi}\over\partial t_1} &amp;
    {\partial\mathbf{\varphi}\over\partial t_2} &amp;
    \cdots &amp;
    {\partial\mathbf{\varphi}\over\partial t_k} \cr
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots \cr
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots \cr
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots \cr
}" /></p>
</div><p>The idea behind this comes from the fact that the volume of the <img class="math" src="../../images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>-dimensional
parallelepiped spanned by the vectors</p>
<div class="math">
<p><img src="../../images/math/750e5fe8e311d2a8f4dce25e0e1ee2e3ad4ccf16.png" alt="{\partial\mathbf{\varphi}\over\partial t_1}, \dots, {\partial\mathbf{\varphi}\over\partial t_k}" /></p>
</div><p>is given by</p>
<div class="math">
<p><img src="../../images/math/563fa29ffd57eccc087863e93ceed7a9de3e8a30.png" alt="V = \sqrt{\det {\bf J}^T{\bf J}}" /></p>
</div><p>where <img class="math" src="../../images/math/acf8b78bcf615f4ed1ad4e04d91f077d86a0d1e9.png" alt="{\bf J}"/> is an <img class="math" src="../../images/math/fa58979ec0dfb0484cbc233a89bf9d79eebbc24b.png" alt="n\times k"/> matrix having those vectors as its column
vectors.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s integrate a function <img class="math" src="../../images/math/7cebc8e877b25bf055ee36f9066a750ee41a9688.png" alt="f(x, y, z)"/> over the surface of a sphere in 3D
(e.g. <img class="math" src="../../images/math/4f681bd84648c174d45eed0037702cae77ed0686.png" alt="k=2"/> and <img class="math" src="../../images/math/5635737307f5f0651cced8ee2e6558a426fd27b5.png" alt="n=3"/>):</p>
<div class="math">
<p><img src="../../images/math/a06a03dfbd7ab3f902831c51f008bbd2077bb254.png" alt="\mathbf{\varphi}(\theta, \phi) = \mat{
    r\sin\theta\cos\phi \cr
    r\sin\theta\sin\phi \cr
    r\cos\theta \cr
}

{\bf J} = \mat{
    -r\sin\theta\sin\phi &amp; r\cos\theta\cos\phi \cr
    r\sin\theta\cos\phi &amp; r\cos\theta\sin\phi \cr
    0 &amp; -r\sin\theta \cr
}

{\bf G} = {\bf J}^T {\bf J} =
\mat{
    -r\sin\theta\sin\phi &amp; r\sin\theta\cos\phi &amp; 0 \cr
    r\cos\theta\cos\phi &amp; r\cos\theta\sin\phi &amp; -r\sin\theta \cr
}
\mat{
    -r\sin\theta\sin\phi &amp; r\cos\theta\cos\phi \cr
    r\sin\theta\cos\phi &amp; r\cos\theta\sin\phi \cr
    0 &amp; -r\sin\theta \cr
}
= \mat {
    r^2\sin^2\theta &amp; 0 \cr
    0 &amp; r^2 \cr
}

\det{\bf G} = r^4\sin^2\theta

\sqrt{\det{\bf G}} = r^2\sin\theta

\int_M f(x, y, z) \d S = \int_{\R^n} f(r\sin\theta\cos\phi,
r\sin\theta\sin\phi, r\cos\theta)\, r^2\sin\theta\,\d\theta\,\d\phi
=

= \int_0^\pi\d\theta \int_0^{2\pi}\d\phi\, f(r\sin\theta\cos\phi,
r\sin\theta\sin\phi, r\cos\theta)\, r^2\sin\theta" /></p>
</div><p>Let&#8217;s say we want to calculate the surface area of a sphere, so we set <img class="math" src="../../images/math/f041d065f40f9b71e34599f1337d96be02008940.png" alt="f(x, y,
z) = 1"/> and get:</p>
<div class="math">
<p><img src="../../images/math/7a0a4c7be6b7ce577a64d8ee819c2a3eabe4d2c9.png" alt="\int_M \d S
= \int_0^\pi\d\theta \int_0^{2\pi}\d\phi\, r^2\sin\theta
= 2\pi r^2\int_0^\pi\d\theta \sin\theta
= 4\pi r^2" /></p>
</div></div>
</div>
<div class="section" id="special-cases">
<h2>Special Cases<a class="headerlink" href="#special-cases" title="Permalink to this headline">¶</a></h2>
<div class="section" id="k-n">
<span id="index-85"></span><h3>k = n<a class="headerlink" href="#k-n" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="../../images/math/617b47c5719641cab5a4f21ce82ec721e21e5a14.png" alt="\det{\bf G} = \det {\bf J}^R{\bf J} = (\det {\bf J})^2

\d S = |\det {\bf J}|\,\d t_1\,\d t_2\cdots\d t_k" /></p>
</div></div>
<div class="section" id="k-1">
<span id="index-86"></span><h3>k = 1<a class="headerlink" href="#k-1" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="../../images/math/25af50743a3d2188d53c7ba2ecf8f594ab9f63f1.png" alt="\det{\bf G} = \det \left(
    \left({\d\varphi_1\over\d t}\right)^2+
    \left({\d\varphi_2\over\d t}\right)^2+
    \cdots
    \right)
= \left|{\d\mathbf{\varphi}\over\d t}\right|^2

\d S = \left|{\d\mathbf{\varphi}\over\d t}\right|\,\d t" /></p>
</div></div>
<div class="section" id="k-n-1">
<span id="index-87"></span><h3>k = n - 1<a class="headerlink" href="#k-n-1" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="../../images/math/6231480525305fbc96793b88e6dd03dfe477da7a.png" alt="\det{\bf G} = \det {\bf J}^R{\bf J} =

=\det(\cdots)^2 + \det(\cdots)^2+\cdots+\det(\dots)^2 =

=\left|\det\mat{
    {\partial\mathbf{\varphi}\over\partial t_1} &amp;
    {\partial\mathbf{\varphi}\over\partial t_2} &amp;
    \cdots &amp;
    {\partial\mathbf{\varphi}\over\partial t_k} &amp;
    {\bf e}_1 \cr
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; {\bf e}_2 \cr
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \cr
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; {\bf e}_n \cr
}\right|^2 \equiv |\omega_\varphi|^2

\d S = |\omega_\varphi|\,\d t_1\,\d t_2\cdots\d t_k" /></p>
</div><p><img class="math" src="../../images/math/996ea44dbdf7256e20d35ae37be061da5f58e8b3.png" alt="\omega_\varphi"/> is a generalization of a vector cross product. The
<img class="math" src="../../images/math/1a44cf37e7594954a62080e15a99fe575ef50007.png" alt="\det(\cdots)"/> symbol means a determinant of a matrix with one row removed
(first term in the sum has first row removed, second term has second row
removed, etc.).</p>
</div>
<div class="section" id="k-2-n-3">
<span id="index-88"></span><h3>k = 2, n = 3<a class="headerlink" href="#k-2-n-3" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="../../images/math/893cc48b48c980d40934e685c6c565a32bf2c883.png" alt="\det{\bf G} = \left|{\partial\mathbf{\varphi}\over\partial t_1}\times
{\partial\mathbf{\varphi}\over\partial t_2}\right|^2

\d S = \left|{\partial\mathbf{\varphi}\over\partial t_1}\times
{\partial\mathbf{\varphi}\over\partial t_2}\right|\,\d t_1\,\d t_2" /></p>
</div></div>
<div class="section" id="y-f-x-z">
<h3>y = f(x, z)<a class="headerlink" href="#y-f-x-z" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="../../images/math/62b3f9c2aaf1e758f4fc6621d0957976c43ac98e.png" alt="\det{\bf G} = 1
+\left({\partial f\over\partial x}\right)^2
+\left({\partial f\over\partial z}\right)^2

\d S = \sqrt{1
+\left({\partial f\over\partial x}\right)^2
+\left({\partial f\over\partial z}\right)^2
}\,\d x\,\d z" /></p>
</div><p>in general for <img class="math" src="../../images/math/fec7486909f405fb73ac0b809c27fd5079fc5e2a.png" alt="x_j = f(x_1, x_2, \dots, x_n)"/> we get:</p>
<div class="math">
<p><img src="../../images/math/438e3b9d7a7dc0df6ea471784e9dd28d1413647a.png" alt="\det{\bf G} = 1
+\left({\partial f\over\partial x_1}\right)^2
+\left({\partial f\over\partial x_2}\right)^2
+\cdots

\d S = \sqrt{1
+\left({\partial f\over\partial x_1}\right)^2
+\left({\partial f\over\partial x_2}\right)^2
+\cdots
}\,\d x_1\,\d x_2\cdots\d x_n" /></p>
</div><p>The &#8220;<img class="math" src="../../images/math/ac0e6fa105993ce976db0dc241d59ab8e68e6efc.png" alt="x_j"/>&#8221; term is missing in the sums above.</p>
</div>
<div class="section" id="implicit-surface">
<span id="index-89"></span><h3>Implicit Surface<a class="headerlink" href="#implicit-surface" title="Permalink to this headline">¶</a></h3>
<p>For a surface given explicitly by</p>
<div class="math">
<p><img src="../../images/math/0c636634de06a2a1918c54b6398667403e642517.png" alt="F(x_1, x_2, ..., x_n) = 0" /></p>
</div><p>we get:</p>
<div class="math">
<p><img src="../../images/math/7bfa25a576c205d99b3932dfa82b003d8c718182.png" alt="\d S = |\nabla F| \left|{\partial F\over\partial x_n}\right|\,\d
x_1\cdots\d x_{n-1}" /></p>
</div></div>
<div class="section" id="orthogonal-coordinates">
<span id="index-90"></span><h3>Orthogonal Coordinates<a class="headerlink" href="#orthogonal-coordinates" title="Permalink to this headline">¶</a></h3>
<p>If the coordinate vectors are orthogonal to each other:</p>
<div class="math">
<p><img src="../../images/math/ce0abca946ddf552cae5d828fb86639262ab863f.png" alt="{\partial\mathbf{\varphi}\over\partial t_i} \cdot
{\partial\mathbf{\varphi}\over\partial t_i} = 0
\quad\text{for $i\neq j$}" /></p>
</div><p>we get:</p>
<div class="math">
<p><img src="../../images/math/530b94e3617c01711dd64756273254137296f68d.png" alt="\d S =
\left|{\partial\mathbf{\varphi}\over\partial t_1}\right|
\left|{\partial\mathbf{\varphi}\over\partial t_2}\right|
\cdots
\left|{\partial\mathbf{\varphi}\over\partial t_k}\right|
\d t_1\cdots\d t_k" /></p>
</div></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Integration</a><ul>
<li><a class="reference external" href="#general-case">General Case</a><ul>
<li><a class="reference external" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference external" href="#special-cases">Special Cases</a><ul>
<li><a class="reference external" href="#k-n">k = n</a></li>
<li><a class="reference external" href="#k-1">k = 1</a></li>
<li><a class="reference external" href="#k-n-1">k = n - 1</a></li>
<li><a class="reference external" href="#k-2-n-3">k = 2, n = 3</a></li>
<li><a class="reference external" href="#y-f-x-z">y = f(x, z)</a></li>
<li><a class="reference external" href="#implicit-surface">Implicit Surface</a></li>
<li><a class="reference external" href="#orthogonal-coordinates">Orthogonal Coordinates</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="../../index.html"
                                  title="previous chapter">Theoretical Physics Reference</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="residue.html"
                                  title="next chapter">Residue Theorem</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../sources/src/math/integration.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="residue.html" title="Residue Theorem"
             >next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Theoretical Physics Reference"
             >previous</a> |</li>
        <li><a href="../../index.html">Theoretical Physics Reference v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009, Ondřej Čertík.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.
    </div>
  </body>
</html>