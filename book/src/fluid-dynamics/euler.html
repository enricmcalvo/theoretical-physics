<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Compressible Euler Equations &mdash; Theoretical Physics Reference v0.1 documentation</title>
    <link rel="stylesheet" href="../../static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../static/jquery.js"></script>
    <script type="text/javascript" src="../../static/doctools.js"></script>
    <link rel="top" title="Theoretical Physics Reference v0.1 documentation" href="../../index.html" />
    <link rel="up" title="Fluid Dynamics" href="main.html" />
    <link rel="next" title="Quantum Field Theory and Quantum Mechanics" href="../quantum/main.html" />
    <link rel="prev" title="MHD Equations" href="mhd.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../quantum/main.html" title="Quantum Field Theory and Quantum Mechanics"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mhd.html" title="MHD Equations"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Theoretical Physics Reference v0.1 documentation</a> &raquo;</li>
          <li><a href="main.html" accesskey="U">Fluid Dynamics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="compressible-euler-equations">
<span id="index-0"></span><h1>Compressible Euler Equations<a class="headerlink" href="#compressible-euler-equations" title="Permalink to this headline">Â¶</a></h1>
<p>The compressible Euler equations are:</p>
<div class="math">
<p><img src="../../images/math/d69b9c659b0cdbefd421e8c361b30d80a78df9fa.png" alt="{\partial\rho\over\partial t} + \nabla\cdot(\rho{\bf u}) = 0

{\partial(\rho{\bf u})\over\partial t} + \nabla\cdot(\rho{\bf u}{\bf u}^T)
    + \nabla p - {\bf f} = 0

{\partial E\over\partial t} + \nabla\cdot({\bf u}(E+p)) = 0" /></p>
</div><p>where</p>
<div class="math">
<p><img src="../../images/math/1d4a88147849c8ecec3d242d4936a262f9a07e85.png" alt="E = \rho e + \half \rho u^2" /></p>
</div><p>is the total energy per unit volume (<img class="math" src="../../images/math/f8ad6e28ee44455107fd5b1fed09336bef89c843.png" alt="\half \rho u^2"/> is the kinetic energy per
unit volume), <img class="math" src="../../images/math/a3a59bb1293ee3f6dec19de4019a7178874219ae.png" alt="e"/> is the internal energy per unit mass (<img class="math" src="../../images/math/6fa3044d505bf62a6173112f964b9723d2d8a0a2.png" alt="e={U\over nM}"/>)
and we use the ideal gas equations, so:</p>
<div class="math">
<p><img src="../../images/math/01d4141f5e4d6834a69915c7869c4c630d579098.png" alt="e = T c_v

p = {n\over V} \bar RT =
{n M\over V} {\bar R\over M}T =
\rho RT = \rho R {e\over c_v} =
    {R\over c_v} (E-\half \rho u^2)" /></p>
</div><p>where
<img class="math" src="../../images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> is the number of moles of gas,
<img class="math" src="../../images/math/5d1e4485dc90c450e8c76826516c1b2ccb8fce16.png" alt="M"/> is the molar mass of the gas (e.g. a mass of one mole of the gas),
<img class="math" src="../../images/math/9c3b49dcc81ad85b2e07f7a8d302be685d605491.png" alt="\rho={n M\over V}"/> is the density of the gas,
<img class="math" src="../../images/math/22344a41e47985033825ea337522a64e707f85ef.png" alt="\bar R"/> is the ideal gas constant,
<img class="math" src="../../images/math/9b9121ebb1fdd07af1274d199583f2c0e80b81be.png" alt="R={\bar R\over M}"/> is the specific ideal gas constant,
<img class="math" src="../../images/math/2f3f2daddf38c751bff3c7b6040d1beb8bde6178.png" alt="c_v"/> is the specific heat capacity at constant volume (e.g. a heat capacity
per unit volume),
<img class="math" src="../../images/math/12d58aa29201da09d8e620f8698e3a37547f6b4a.png" alt="V"/> is the volume
and <img class="math" src="../../images/math/2554b6496c3b678897e9b060ef00aa9f0a7d7ece.png" alt="T"/> is the temperature of the gas.
Of those, <img class="math" src="../../images/math/12d58aa29201da09d8e620f8698e3a37547f6b4a.png" alt="V"/>, <img class="math" src="../../images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>, <img class="math" src="../../images/math/5d1e4485dc90c450e8c76826516c1b2ccb8fce16.png" alt="M"/>, <img class="math" src="../../images/math/eff43e84f8a3bcf7b6965f0a3248bc4d3a9d0cd4.png" alt="R"/>, <img class="math" src="../../images/math/22344a41e47985033825ea337522a64e707f85ef.png" alt="\bar R"/> are constants, <img class="math" src="../../images/math/0027034d8a10372a06deaf4f4084c01956587479.png" alt="\rho"/>, <img class="math" src="../../images/math/a3a59bb1293ee3f6dec19de4019a7178874219ae.png" alt="e"/>, <img class="math" src="../../images/math/fa2fa899f0afb05d6837885523503a2d4df434f9.png" alt="E"/> and <img class="math" src="../../images/math/2554b6496c3b678897e9b060ef00aa9f0a7d7ece.png" alt="T"/> are
functions of <img class="math" src="../../images/math/7bff5231ba7fa776f904320431eabfc7a8253860.png" alt="(t, x, y, z)"/>.</p>
<p>We use the substitution:</p>
<div class="math">
<p><img src="../../images/math/fd5a50ad30aa134c0d71258f9984d54fae760be2.png" alt="{\bf U} = \rho {\bf u}

p = {R\over c_v} (E-\half \rho u^2) =
    {R\over c_v} \left(E-{{\bf U}^2\over2\rho}\right)" /></p>
</div><p>and we get:</p>
<div class="math">
<p><img src="../../images/math/854896046b4ab096f052afc5eb0e84e80a36567d.png" alt="{\partial\rho\over\partial t} + \nabla\cdot{\bf U} = 0

{\partial{\bf U}\over\partial t}
    + \nabla\cdot\left({{\bf U}{\bf U}^T\over\rho}+p\one\right)
    - {\bf f} = 0

{\partial E\over\partial t}
    + \nabla\cdot\left({{\bf U}\over\rho}(E+p)\right) = 0" /></p>
</div><p>Now we write <img class="math" src="../../images/math/6469d09cbc05e257dedf1752400e040c3d1cae03.png" alt="{\bf U} = (U, V, W)"/> and we get:</p>
<div class="math">
<p><img src="../../images/math/0cf92093463953430ff0acd6c75eff77a9b82bd8.png" alt="\frac{\partial}{\partial t} \left( \begin{array}{c}
       \varrho\\ U\\ V\\ W\\ E
   \end{array} \right)
   + \frac{\partial}{\partial x} \left( \begin{array}{c}
       U\\
       \frac{U^2}{\varrho} + p\\
       \frac{UV}{\varrho}\\
       \frac{UW}{\varrho}\\
       \frac{U}{\varrho}(E+p)
   \end{array} \right)
   + \frac{\partial}{\partial y} \left( \begin{array}{c}
       V\\
       \frac{VU}{\varrho}\\
       \frac{V^2}{\varrho} + p\\
       \frac{VW}{\varrho}\\
       \frac{V}{\varrho}(E+p)
   \end{array} \right)
   + \frac{\partial}{\partial z} \left( \begin{array}{c}
       W\\
       \frac{WU}{\varrho}\\
       \frac{WV}{\varrho}\\
       \frac{W^2}{\varrho} + p\\
       \frac{W}{\varrho}(E+p)
   \end{array} \right) + \left( \begin{array}{c}
       0\\
       -f_x\\
       -f_y\\
       -f_z\\
       0\\
   \end{array} \right) =
   \left( \begin{array}{c} 0\\ 0\\ 0\\ 0\\ 0 \end{array} \right)

p = {R\over c_v} \left(E-{U^2+V^2+W^2\over2\rho}\right)" /></p>
</div><p>We solve for the unknowns <img class="math" src="../../images/math/0027034d8a10372a06deaf4f4084c01956587479.png" alt="\rho"/>, <img class="math" src="../../images/math/e2bbebb3bd73f1ae5c64098ab0244f739abf7ca4.png" alt="U"/>, <img class="math" src="../../images/math/12d58aa29201da09d8e620f8698e3a37547f6b4a.png" alt="V"/>, <img class="math" src="../../images/math/10cb764f88509fb1c8012366993fdbee98f31bc5.png" alt="W"/> and <img class="math" src="../../images/math/fa2fa899f0afb05d6837885523503a2d4df434f9.png" alt="E"/> as functions of <img class="math" src="../../images/math/c3dfd00e808ace22fbadde43e7eb7967b8c72fa0.png" alt="(t,
x, y, z)"/>, the rest (<img class="math" src="../../images/math/eff43e84f8a3bcf7b6965f0a3248bc4d3a9d0cd4.png" alt="R"/>, <img class="math" src="../../images/math/2f3f2daddf38c751bff3c7b6040d1beb8bde6178.png" alt="c_v"/>, <img class="math" src="../../images/math/77e2657b57cae321de481018d6dc74dd9920abc6.png" alt="f_x"/>, <img class="math" src="../../images/math/f4e24d769d1159c51257a0aef9390c2ef290a2c6.png" alt="f_y"/>, <img class="math" src="../../images/math/dbbdd66231f90d86cd4154819a47260c378b7ebe.png" alt="f_z"/>) are either constants or
depend on the unknowns.</p>
<p>After introducing:</p>
<div class="math">
<p><img src="../../images/math/67885b5de1eb3ce2cc9e6045c771403e57110cd9.png" alt="{\bf w} =
   \left( \begin{array}{c}
       \varrho\\ U\\ V\\ W\\ E
   \end{array} \right)
   =
   \left( \begin{array}{c}
       \varrho\\ \rho u_1\\ \rho u_2\\ \rho u_3\\ E
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_0 \\
       w_1 \\
       w_2 \\
       w_3 \\
       w_4 \\
   \end{array} \right)

{\bf f}_x =
   \left( \begin{array}{c}
       U\\
       \frac{U^2}{\varrho} + p\\
       \frac{UV}{\varrho}\\
       \frac{UW}{\varrho}\\
       \frac{U}{\varrho}(E+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_1\\
       \frac{w_1^2}{w_0} + p\\
       \frac{w_1w_2}{w_0}\\
       \frac{w_1w_3}{w_0}\\
       \frac{w_1}{w_0}(w_4+p)
   \end{array} \right)

{\bf f}_y =
   \left( \begin{array}{c}
       V\\
       \frac{VU}{\varrho}\\
       \frac{V^2}{\varrho} + p\\
       \frac{VW}{\varrho}\\
       \frac{V}{\varrho}(E+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_2\\
       \frac{w_2w_1}{w_0}\\
       \frac{w_2^2}{w_0} + p\\
       \frac{w_2w_3}{w_0}\\
       \frac{w_2}{w_0}(w_4+p)
   \end{array} \right)

{\bf f}_z =
   \left( \begin{array}{c}
       W\\
       \frac{WU}{\varrho}\\
       \frac{WV}{\varrho}\\
       \frac{W^2}{\varrho} + p\\
       \frac{W}{\varrho}(E+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_3\\
       \frac{w_3w_1}{w_0}\\
       \frac{w_3w_2}{w_0}\\
       \frac{w_3^2}{w_0} + p\\
       \frac{w_3}{w_0}(w_4+p)
   \end{array} \right)

{\bf g} =
   \left( \begin{array}{c}
       0\\
       -f_x\\
       -f_y\\
       -f_z\\
       0\\
   \end{array} \right)

p = {R\over c_v} \left(E-{U^2+V^2+W^2\over2\rho}\right)
= {R\over c_v} \left(w_4-{w_1^2+w_2^2+w_3^2\over2w_0}\right)" /></p>
</div><p>we can then write the equations as:</p>
<div class="math">
<p><img src="../../images/math/64496c86e0a6387b7128880337db87b8d33c3019.png" alt="{\partial{\bf w}\over \partial t} +
{\partial{\bf f}_x\over \partial x} +
{\partial{\bf f}_y\over \partial y} +
{\partial{\bf f}_z\over \partial z} +
{\bf g}= 0" /></p>
</div><p>Note: <img class="math" src="../../images/math/96a3f06f5875f4560cf6d3150df2b910253d25c4.png" alt="{\bf U}\equiv{\bf j}"/>, where <img class="math" src="../../images/math/2f03ee335cd302ac22c46cb21d5f9c5ddaf9090b.png" alt="{\bf j}"/> is the fluid density current
(it&#8217;s a 3-vector) and also <img class="math" src="../../images/math/a18ae5344d251543ce240b4553702821b8f7031b.png" alt="w^\mu \equiv j^\mu"/> (here <img class="math" src="../../images/math/9fbf92107df2b38bd92147dfa4610a1ca3226b82.png" alt="w^\mu"/> is the same as
<img class="math" src="../../images/math/98bf8a59ca1556a6af9b5bd2a1a447dc7246a133.png" alt="w_\mu"/>, e.g. we are a bit sloppy about the notation), where <img class="math" src="../../images/math/2ce8c0411ae2c21e0a52190831491721e983a2ab.png" alt="j^\mu"/> is the
density 4-current (e.g. the first 4 components of <img class="math" src="../../images/math/617e8d9a63e644648e5c0ea450662ac513a01982.png" alt="{\bf w}"/> are exactly the
components of the 4-current <img class="math" src="../../images/math/2ce8c0411ae2c21e0a52190831491721e983a2ab.png" alt="j^\mu"/>):</p>
<div class="math">
<p><img src="../../images/math/7d2818944a8ebb6705c28d019819b59bea0f5b96.png" alt="j^\mu =\rho v^\mu = \rho\gamma (c, {\bf u}) =
    \gamma
    \left( \begin{array}{c}
        c\rho\\
        \rho u_1\\
        \rho u_2\\
        \rho u_3\\
    \end{array} \right)" /></p>
</div><p>where as usual <img class="math" src="../../images/math/fe5def4fb1a4e54a22615dfe561df616755674f6.png" alt="\mu = 0, 1, 2, 3"/> is the relativistic index, <img class="math" src="../../images/math/3372c1cb6d68cf97c2d231acc0b47b95a9ed04cc.png" alt="c"/> is the speed
of light, and in the nonrelativistic limit (<img class="math" src="../../images/math/5aed179f587c3ac274cb5c3135b4ec6a8a3e9c80.png" alt="c\to\infty"/>) we get <img class="math" src="../../images/math/fd87634f51bf39f0d58a4f4fad4b06811548d530.png" alt="\gamma\to1"/>
and the remaining <img class="math" src="../../images/math/3372c1cb6d68cf97c2d231acc0b47b95a9ed04cc.png" alt="c"/> in <img class="math" src="../../images/math/4b661724ec110c6979e057a96abf606de0f21a22.png" alt="j^0"/> will cancel with <img class="math" src="../../images/math/3372c1cb6d68cf97c2d231acc0b47b95a9ed04cc.png" alt="c"/> in
<img class="math" src="../../images/math/ab56fb5bd9ba2e2e251296afa1d913e44c4555e1.png" alt="\partial_0 = {1\over c}{\partial\over\partial t}"/>,
so it will not be present in the final equations (that involve terms like
<img class="math" src="../../images/math/0e35888fdeaf118cf2494e17958e6b1d31c6f2af.png" alt="\partial_\mu j^\mu"/>). We can also just set <img class="math" src="../../images/math/0e4cc644ec8a1c3623c13ed3d14904096a0d87b9.png" alt="c=1"/> as usual in relativistic
physics.</p>
<p>Now we write the spatial derivatives using so called flux Jacobians
<img class="math" src="../../images/math/7cd2e4892212a8a5b973e2add40bc4dc5aef0eec.png" alt="{\bf A}_x"/>,
<img class="math" src="../../images/math/6a55da3074a4683c7d927c5286f49f00100be9c9.png" alt="{\bf A}_y"/>
and
<img class="math" src="../../images/math/82b183cd47f646636734b8e25ff3fa7d5e04cfac.png" alt="{\bf A}_z"/>:</p>
<div class="math">
<p><img src="../../images/math/aaa4d41598073ec70289c0a8074cfd7abc006b02.png" alt="{\partial{\bf f}_x\over \partial x} =
{\partial{\bf f}_x\over \partial {\bf w}}
{\partial{\bf w}\over \partial x} \equiv
{\bf A}_x
{\partial{\bf w}\over \partial x}

{\bf A}_x={\bf A}_x({\bf w})\equiv{\partial{\bf f}_x\over \partial {\bf w}}" /></p>
</div><p>Similarly for <img class="math" src="../../images/math/092e364e1d9d19ad5fffb0b46ef4cc7f2da02c1c.png" alt="y"/> and <img class="math" src="../../images/math/b13f21416d84e13708696f34dea81026cda583c9.png" alt="z"/>, so we get:</p>
<div class="math">
<p><img src="../../images/math/7bb2506a2b1bc6ce2ecaa791c977cfed3f22a91e.png" alt="{\partial{\bf w}\over \partial t} +
{\bf A}_x
{\partial{\bf w}\over \partial x} +
{\bf A}_y
{\partial{\bf w}\over \partial y} +
{\bf A}_z
{\partial{\bf w}\over \partial z} +
{\bf g}= 0" /></p>
</div><p>One nice thing about these particular
<img class="math" src="../../images/math/d195085ac6d735eff88a6561b7c7b41173b64150.png" alt="{\bf f}_x"/>,
<img class="math" src="../../images/math/b5c9cd8e5a2854dd234d54d5fa1b4642586df2c1.png" alt="{\bf f}_y"/> and
<img class="math" src="../../images/math/726bc7b2acffee8eafc1526c6ec47c65e3591c69.png" alt="{\bf f}_z"/> functions is that they are homogeneous of degree 1:</p>
<div class="math">
<p><img src="../../images/math/c017aa9d5409039a01b6cbeb2fbb0a9ee00d7124.png" alt="{\bf f}_x(\lambda{\bf w})
=\lambda\,{\bf f}_x({\bf w})" /></p>
</div><p>so the Euler equation/formula for the homogeneous function is:</p>
<div class="math">
<p><img src="../../images/math/6fb56119cef89dd097575efc1191dd7090d0fe6c.png" alt="{\bf w}\cdot {\partial {\bf f}_x({\bf w})\over\partial {\bf w}}
={\bf f}_x({\bf w})

{\bf w}\cdot {\bf A}_x ={\bf f}_x({\bf w})" /></p>
</div><p>So both the <img class="math" src="../../images/math/d195085ac6d735eff88a6561b7c7b41173b64150.png" alt="{\bf f}_x"/> and it&#8217;s derivative can be nicely factored out using
the flux Jacobian:</p>
<div class="math">
<p><img src="../../images/math/b41533d695b3c28e4bd63a8e700dd67828376cbb.png" alt="{\bf f}_x = {\bf A}_x\, {\bf w}

{\partial{\bf f}_x\over \partial x} =
    {\bf A}_x {\partial{\bf w}\over \partial x}" /></p>
</div><p>by differentiating the first equation and substracting the second, we get:</p>
<div class="math">
<p><img src="../../images/math/c1f0fd13876c360409dfa027ef430ad4cfd28dd7.png" alt="{\partial {\bf A}_x\over\partial x}\, {\bf w} = 0" /></p>
</div><p>similarly for <img class="math" src="../../images/math/092e364e1d9d19ad5fffb0b46ef4cc7f2da02c1c.png" alt="y"/> and <img class="math" src="../../images/math/b13f21416d84e13708696f34dea81026cda583c9.png" alt="z"/>.
To calculate the Jacobians, we&#8217;ll need:</p>
<div class="math">
<p><img src="../../images/math/b1f2b936423e70cc8e26b474c5654d3d1ed39fce.png" alt="{\partial p\over \partial {\bf w}}=
    {R\over c_v}
    \left( \begin{array}{ccccc}
        {w_1^2+w_2^2+w_3^2\over 2w_0^2} &amp; -{w_1\over w_0} &amp; -{w_2\over w_0}
            &amp; -{w_3\over w_0} &amp; 1\\
    \end{array} \right)" /></p>
</div><p>then we can calculate the Jacobians (and we substitute for <img class="math" src="../../images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/>):</p>
<div class="math">
<p><img src="../../images/math/15303b51ff9464fb2cbb9098b3ef1976546d4d70.png" alt="{\bf A}_x({\bf w}) = {\partial{\bf f}_x\over \partial {\bf w}}=
    \left( \begin{array}{ccccc}
        0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
        -{w_1^2\over w_0^2} +{R\over c_v}{w_1^2+w_2^2+w_3^2\over 2 w_0^2} &amp;
            {2w_1\over w_0}-{R\over c_v}{w_1\over w_0} &amp;
            -{R\over c_v}{w_2\over w_0} &amp;
            -{R\over c_v}{w_3\over w_0} &amp;
            {R\over c_v}\\
        -{w_1w_2\over w_0^2} &amp; {w_2\over w_0} &amp; {w_1\over w_0} &amp; 0 &amp; 0\\
        -{w_1w_3\over w_0^2} &amp; {w_3\over w_0} &amp; 0 &amp; {w_1\over w_0} &amp; 0 \\
            -{w_1w_4\over w_0^2}-{w_1\over w_0^2}{R\over c_v}
                \left(w_4-{w_1^2+w_2^2+w_3^2\over 2 w_0}\right)
                +{w_1\over w_0}{R\over c_v}{w_1^2+w_2^2+w_3^2\over 2 w_0^2}&amp;
            {w_4\over w_0}+{1\over w_0}{R\over c_v}
                \left(w_4-{w_1^2+w_2^2+w_3^2\over 2 w_0}\right)
                -{R\over c_v}{w_1^2\over w_0^2} &amp;
            -{R\over c_v}{w_1w_2\over w_0^2} &amp;
            -{R\over c_v}{w_1w_3\over w_0^2} &amp;
            {w_1\over w_0}+{R\over c_v}{w_1\over w_0} \\
   \end{array} \right)

{\bf A}_y({\bf w}) = {\partial{\bf f}_y\over \partial {\bf w}}=
    \left( \begin{array}{ccccc}
        0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
        -{w_2w_1\over w_0^2} &amp; {w_2\over w_0} &amp; {w_1\over w_0} &amp; 0 &amp; 0\\
        -{w_2^2\over w_0^2} +{R\over c_v}{w_1^2+w_2^2+w_3^2\over 2 w_0^2} &amp;
            -{R\over c_v}{w_1\over w_0} &amp;
            {2w_2\over w_0}-{R\over c_v}{w_2\over w_0} &amp;
            -{R\over c_v}{w_3\over w_0} &amp;
            {R\over c_v}\\
        -{w_2w_3\over w_0^2} &amp; 0 &amp; {w_3\over w_0} &amp; {w_2\over w_0} &amp; 0 \\
        \cdot &amp; \cdot &amp; \cdot &amp; \cdot &amp; \cdot \\
   \end{array} \right)

{\bf A}_z({\bf w}) = {\partial{\bf f}_z\over \partial {\bf w}}=
    \left( \begin{array}{ccccc}
        0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
        -{w_3w_1\over w_0^2} &amp; {w_3\over w_0} &amp; 0 &amp; {w_1\over w_0} &amp; 0 \\
        -{w_3w_2\over w_0^2} &amp; 0 &amp; {w_3\over w_0} &amp; {w_2\over w_0} &amp; 0 \\
        -{w_3^2\over w_0^2} +{R\over c_v}{w_1^2+w_2^2+w_3^2\over 2 w_0^2} &amp;
            -{R\over c_v}{w_1\over w_0} &amp;
            -{R\over c_v}{w_2\over w_0} &amp;
            {2w_3\over w_0} -{R\over c_v}{w_3\over w_0} &amp;
            {R\over c_v}\\
            -{w_3w_4\over w_0^2}-{w_3\over w_0^2}{R\over c_v}
                \left(w_4-{w_1^2+w_2^2+w_3^2\over 2 w_0}\right)
                +{w_3\over w_0}{R\over c_v}{w_1^2+w_2^2+w_3^2\over 2 w_0^2}&amp;
            -{R\over c_v}{w_3w_1\over w_0^2} &amp;
            -{R\over c_v}{w_3w_2\over w_0^2} &amp;
            {w_4\over w_0}+{1\over w_0}{R\over c_v}
                \left(w_4-{w_1^2+w_2^2+w_3^2\over 2 w_0}\right)
                -{R\over c_v}{w_3^2\over w_0^2} &amp;
            {w_3\over w_0}+{R\over c_v}{w_3\over w_0} \\
   \end{array} \right)" /></p>
</div><div class="section" id="dimensionless-euler-equations">
<h2>Dimensionless Euler Equations<a class="headerlink" href="#dimensionless-euler-equations" title="Permalink to this headline">Â¶</a></h2>
<p>We choose 3 constants <img class="math" src="../../images/math/9fbaf37cdf312a79feacdd0d22f1424ed81248d8.png" alt="l_r"/>, <img class="math" src="../../images/math/59ca6d8c556ddbab115d04ad997cc7ded5fa478c.png" alt="u_r"/> and <img class="math" src="../../images/math/108c8543e4b443a0d96fa829fe99d46ef44cef53.png" alt="\rho_r"/> - characteristic length of the
domain, velocity and density. Now we multiply the Euler equations with proper
combinations of these constants as follows:</p>
<div class="math">
<p><img src="../../images/math/d4df14877602100161929030f93c71856f41cf6e.png" alt="\left[{\partial\rho\over\partial t} + \nabla\cdot(\rho{\bf u})\right]
{l_r\over\rho_r u_r}
= 0

\left[{\partial(\rho{\bf u})\over\partial t} + \nabla\cdot(\rho{\bf u}{\bf u}^T)
    + \nabla p - {\bf f}\right]
{l_r\over\rho_r u_r^2}
= 0

\left[{\partial E\over\partial t} + \nabla\cdot({\bf u}(E+p))\right]
{l_r\over\rho_r u_r^3}
= 0" /></p>
</div><p>This is equal to:</p>
<div class="math">
<p><img src="../../images/math/1b7391c22906d326139ce0412b309b4778d3bb0b.png" alt="{\partial\tilde\rho\over\partial \tilde t} + \tilde\nabla\cdot(\tilde\rho
\tilde{\bf u}) = 0

{\partial(\tilde \rho\tilde{\bf u})\over\partial \tilde t} +
    \tilde\nabla\cdot(\tilde\rho\tilde{\bf u}\tilde{\bf u}^T)
    + \tilde\nabla\tilde p - \tilde{\bf f} = 0

{\partial\tilde E\over\partial\tilde t} + \tilde\nabla\cdot(
\tilde{\bf u}(\tilde E+\tilde p)) = 0" /></p>
</div><p>where:</p>
<div class="math">
<p><img src="../../images/math/2c1160ce117720f7968f8bed24275c443c4063d3.png" alt="t_r = {l_r\over u_r}

\tilde t = {t\over t_r}

\tilde \rho = {\rho\over\rho_r}

\tilde{\bf u} = {{\bf u}\over u_r}

\tilde\nabla = l_r\nabla

\tilde E = {E\over \rho_r u^2_r}

\tilde p = {p\over \rho_r u^2_r}

\tilde {\bf f} = {\bf f}{l_r\over\rho_r u^2_r}" /></p>
</div><p>In particular, if <img class="math" src="../../images/math/732af79eefc078ee68704a18a7ececdfab120dc1.png" alt="{\bf f}=(0, 0, -\rho g)"/>, then</p>
<div class="math">
<p><img src="../../images/math/87770216979ff0e800d28c56d938a17760353409.png" alt="\tilde{\bf f}=(0, 0, -\tilde\rho \tilde g)

\tilde g = g{l_r\over u^2_r} = g{t_r^2\over l_r}" /></p>
</div><div class="section" id="fem-formulation">
<h3>FEM Formulation<a class="headerlink" href="#fem-formulation" title="Permalink to this headline">Â¶</a></h3>
<p>The Euler equations:</p>
<div class="math">
<p><img src="../../images/math/9078d8cb93e9838a446248bbb5b274cc20c4c9d1.png" alt="{\partial{\bf w}\over \partial t} +
{\bf A}_x({\bf w})
{\partial{\bf w}\over \partial x} +
{\bf A}_y({\bf w})
{\partial{\bf w}\over \partial y} +
{\bf A}_z({\bf w})
{\partial{\bf w}\over \partial z} +
{\bf g}= 0" /></p>
</div><p>are nonlinear. The simplest approximation is to linearize them by:</p>
<div class="math">
<p><img src="../../images/math/20f854a4ff34535670d25c1e77f02b26c954d0e0.png" alt="{{\bf w}^{n+1}-{\bf w}^n\over \tau} +
{\bf A}_x({\bf w}^n)
{\partial{\bf w}^{n+1}\over \partial x} +
{\bf A}_y({\bf w}^n)
{\partial{\bf w}^{n+1}\over \partial y} +
{\bf A}_z({\bf w}^n)
{\partial{\bf w}^{n+1}\over \partial z} +
{\bf g}= 0" /></p>
</div><p>Then we multiply by the test functions (one by one):</p>
<div class="math">
<p><img src="../../images/math/3340312bcde8c04c7c4bbc7e1d7d66d9bd30aff1.png" alt="\left( \begin{array}{c}
    \varphi^0 \\
    0 \\
    0 \\
    0 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    \varphi^1 \\
    0 \\
    0 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    0 \\
    \varphi^2 \\
    0 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    0 \\
    0 \\
    \varphi^3 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    0 \\
    0 \\
    0 \\
    \varphi^4 \\
\end{array} \right)" /></p>
</div><p>and integrate over the 3D domain <img class="math" src="../../images/math/9e2b196e9b7e57d1ec99f6534c581ea9759d2170.png" alt="\Omega"/>, so we get (here the index
<img class="math" src="../../images/math/a859cf4d934ceb063567af10283152e529a1c7d6.png" alt="i=0, 1, 2, 3, 4"/> is numbering the 5 equations, so we are <em>not</em> summing over
it):</p>
<div class="math">
<p><img src="../../images/math/805b203d265b8821eef7bb3cd3a412928d9a1e23.png" alt="\int_{\Omega} {w_i^{n+1}-w_i^n\over\tau}\varphi^i
    + \left({\bf A}_x({\bf w}^n)\right)_{ij}
      {\partial w_j^{n+1}\over\partial x} \varphi^i
    + \left({\bf A}_y({\bf w}^n)\right)_{ij}
      {\partial w_j^{n+1}\over\partial y} \varphi^i
    + \left({\bf A}_z({\bf w}^n)\right)_{ij}
      {\partial w_j^{n+1}\over\partial z} \varphi^i
    + g_i \varphi^i
    \ \d^3 x
    =0" /></p>
</div><p>Now we integrate by parts and use the homogeneity property (
<img class="math" src="../../images/math/1e2e2e8061e3e09e81794f1b56d81c146de9a523.png" alt="w_j {\partial\left({\bf A}_z({\bf w}^n)\right)_{ij}\over\partial x}
\varphi^i = 0"/>):</p>
<div class="math">
<p><img src="../../images/math/95b0e7d4225eede9bf59dfc2615d0d966138855f.png" alt="\int_{\Omega} {w_i^{n+1}-w_i^n\over\tau}\varphi^i
    - \left({\bf A}_x({\bf w}^n)\right)_{ij}
      w_j^{n+1} {\partial \varphi^i\over\partial x}
    - \left({\bf A}_y({\bf w}^n)\right)_{ij}
      w_j^{n+1} {\partial \varphi^i\over\partial y}
    - \left({\bf A}_z({\bf w}^n)\right)_{ij}
      w_j^{n+1} {\partial \varphi^i\over\partial z}
    + g_i \varphi^i
    \ \d^3 x
    +

+\int_{\partial\Omega}
\left({\bf A}_x({\bf w}^n)\right)_{ij}w_j^{n+1}
    \varphi^i\, n_x
+ \left({\bf A}_y({\bf w}^n)\right)_{ij}w_j^{n+1}
    \varphi^i\, n_y
+ \left({\bf A}_z({\bf w}^n)\right)_{ij}w_j^{n+1}
    \varphi^i\, n_z
\ \d^2 x
=0" /></p>
</div><p>where <img class="math" src="../../images/math/7f2d58d6348e91be0cd7b230edffcdd273170454.png" alt="{\bf n} = (n_x, n_y, n_z)"/> is the outward surface normal to
<img class="math" src="../../images/math/6720af89712e36d5af405fb7adf80ec1f04b211a.png" alt="\partial\Omega"/>. Rearranging:</p>
<div class="math">
<p><img src="../../images/math/8cf7e8ff13e58b449284e19e0191778e9d99a6d0.png" alt="\int_{\Omega} {w_i^{n+1}\over\tau}\varphi^i
    - \left({\bf A}_x({\bf w}^n)\right)_{ij}
      w_j^{n+1} {\partial \varphi^i\over\partial x}
    - \left({\bf A}_y({\bf w}^n)\right)_{ij}
      w_j^{n+1} {\partial \varphi^i\over\partial y}
    - \left({\bf A}_z({\bf w}^n)\right)_{ij}
      w_j^{n+1} {\partial \varphi^i\over\partial z}
    \ \d^3 x
    +

+\int_{\partial\Omega}
\left({\bf A}_x({\bf w}^n)\right)_{ij}w_j^{n+1}
    \varphi^i\, n_x
+ \left({\bf A}_y({\bf w}^n)\right)_{ij}w_j^{n+1}
    \varphi^i\, n_y
+ \left({\bf A}_z({\bf w}^n)\right)_{ij}w_j^{n+1}
    \varphi^i\, n_z
\ \d^2 x
=
\int_{\Omega} {w_i^n\over\tau}\varphi^i
    - g_i \varphi^i
    \ \d^3 x" /></p>
</div></div>
<div class="section" id="sea-breeze-modeling">
<h3>Sea Breeze Modeling<a class="headerlink" href="#sea-breeze-modeling" title="Permalink to this headline">Â¶</a></h3>
<p>In our model we make the following assumptions:</p>
<div class="math">
<p><img src="../../images/math/b53f3937156cbc3b18807df7bb52b40e99d1a855.png" alt="f_x = 0

f_y = 0

f_z = -\rho g = -w_0 g

V = 0

{\partial U\over\partial y}
={\partial V\over\partial y}
={\partial W\over\partial y}
={\partial E\over\partial y}=0" /></p>
</div><p>so we get a 2D model:</p>
<div class="math">
<p><img src="../../images/math/affd3a9d0402c406663e783b3bf50b6aecff5b2c.png" alt="\frac{\partial}{\partial t} \left( \begin{array}{c}
       \varrho\\ U\\ 0\\ W\\ E
   \end{array} \right)
   + \frac{\partial}{\partial x} \left( \begin{array}{c}
       U\\
       \frac{U^2}{\varrho} + p\\
       0\\
       \frac{UW}{\varrho}\\
       \frac{U}{\varrho}(E+p)
   \end{array} \right)
   + \frac{\partial}{\partial z} \left( \begin{array}{c}
       W\\
       \frac{WU}{\varrho}\\
       0\\
       \frac{W^2}{\varrho} + p\\
       \frac{W}{\varrho}(E+p)
   \end{array} \right) + \left( \begin{array}{c}
       0\\
       0\\
       0\\
       \rho g\\
       0\\
   \end{array} \right) =
   \left( \begin{array}{c} 0\\ 0\\ 0\\ 0\\ 0 \end{array} \right)

p = {R\over c_v} \left(E-{U^2+W^2\over2\rho}\right)" /></p>
</div><p>where we prescribe <img class="math" src="../../images/math/eff43e84f8a3bcf7b6965f0a3248bc4d3a9d0cd4.png" alt="R"/>, <img class="math" src="../../images/math/2f3f2daddf38c751bff3c7b6040d1beb8bde6178.png" alt="c_v"/>, <img class="math" src="../../images/math/311cabda3a9b09f0dde217303ca9d1cd9201dcf6.png" alt="g"/> and solve for <img class="math" src="../../images/math/0027034d8a10372a06deaf4f4084c01956587479.png" alt="\rho"/>, <img class="math" src="../../images/math/e2bbebb3bd73f1ae5c64098ab0244f739abf7ca4.png" alt="U"/>, <img class="math" src="../../images/math/10cb764f88509fb1c8012366993fdbee98f31bc5.png" alt="W"/> and <img class="math" src="../../images/math/fa2fa899f0afb05d6837885523503a2d4df434f9.png" alt="E"/> as
functions of <img class="math" src="../../images/math/d7a523c5e13d7478aeb5661332a7e61e8aef496b.png" alt="(t, x, z)"/>. We delete the row for <img class="math" src="../../images/math/092e364e1d9d19ad5fffb0b46ef4cc7f2da02c1c.png" alt="y"/>, which only contains zeros
anyway and introduce:</p>
<div class="math">
<p><img src="../../images/math/a5d73c108c94443457ed8d7d531a71847d1f52fb.png" alt="{\bf w} =
   \left( \begin{array}{c}
       \varrho\\ \rho u_1\\ \rho u_3\\ E
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_0 \\
       w_1 \\
       w_3 \\
       w_4 \\
   \end{array} \right)" /></p>
</div><div class="math">
<p><img src="../../images/math/2b41722067a077eb3af96b7e3b51924948cdb759.png" alt="{\bf A}_x({\bf w}) = {\partial{\bf f}_x\over \partial {\bf w}}=
    \left( \begin{array}{cccc}
        0 &amp; 1 &amp; 0 &amp; 0\\
        -{w_1^2\over w_0^2} +{R\over c_v}{w_1^2+w_3^2\over 2 w_0^2} &amp;
            {2w_1\over w_0}-{R\over c_v}{w_1\over w_0} &amp;
            -{R\over c_v}{w_3\over w_0} &amp;
            {R\over c_v}\\
        -{w_1w_3\over w_0^2} &amp; {w_3\over w_0} &amp; {w_1\over w_0} &amp; 0 \\
            -{w_1w_4\over w_0^2}-{w_1\over w_0^2}{R\over c_v}
                \left(w_4-{w_1^2+w_3^2\over 2 w_0}\right)
                +{w_1\over w_0}{R\over c_v}{w_1^2+w_3^2\over 2 w_0^2} &amp;
            {w_4\over w_0}+{1\over w_0}{R\over c_v}
                \left(w_4-{w_1^2+w_3^2\over 2 w_0}\right)
                -{R\over c_v}{w_1^2\over w_0^2} &amp;
            -{R\over c_v}{w_1w_3\over w_0^2} &amp;
            {w_1\over w_0}+{R\over c_v}{w_1\over w_0} \\
   \end{array} \right)

{\bf A}_z({\bf w}) = {\partial{\bf f}_z\over \partial {\bf w}}=
    \left( \begin{array}{cccc}
        0 &amp; 0 &amp; 1 &amp; 0\\
        -{w_3w_1\over w_0^2} &amp; {w_3\over w_0} &amp; {w_1\over w_0} &amp; 0 \\
        -{w_3^2\over w_0^2} +{R\over c_v}{w_1^2+w_3^2\over 2 w_0^2} &amp;
            -{R\over c_v}{w_1\over w_0} &amp;
            {2w_3\over w_0} -{R\over c_v}{w_3\over w_0} &amp;
            {R\over c_v}\\
        -{w_3w_4\over w_0^2}-{w_3\over w_0^2}{R\over c_v}
                \left(w_4-{w_1^2+w_3^2\over 2 w_0}\right)
                +{w_3\over w_0}{R\over c_v}{w_1^2+w_3^2\over 2 w_0^2}&amp;
            -{R\over c_v}{w_3w_1\over w_0^2} &amp;
            {w_4\over w_0}+{1\over w_0}{R\over c_v}
                \left(w_4-{w_1^2+w_3^2\over 2 w_0}\right)
                -{R\over c_v}{w_3^2\over w_0^2} &amp;
            {w_3\over w_0}+{R\over c_v}{w_3\over w_0} \\
   \end{array} \right)" /></p>
</div><p>The weak formulation in 2D is (here <img class="math" src="../../images/math/ba477ea6059b5239cdcc20f505b5bfd2ba8da2b2.png" alt="i = 0, 1, 3, 4"/>):</p>
<div class="math">
<p><img src="../../images/math/4bc90524a97d20cd5fbf110347d27f5835b684bb.png" alt="\int_{\Omega} {w_i^{n+1}\over\tau}\varphi^i
    - \left({\bf A}_x({\bf w}^n)\right)_{ij}
      w_j^{n+1} {\partial \varphi^i\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{ij}
      w_j^{n+1} {\partial \varphi^i\over\partial z}
    \ \d^2 x
    +

+\int_{\partial\Omega}
\left({\bf A}_x({\bf w}^n)\right)_{ij}w_j^{n+1}
    \varphi^i\, n_x
+ \left({\bf A}_z({\bf w}^n)\right)_{ij}w_j^{n+1}
    \varphi^i\, n_z
\ \d x
=
\int_{\Omega} {w_i^n\over\tau}\varphi^i
    - g_i \varphi^i
    \ \d^2 x" /></p>
</div><p>In order to specify the input forms for Hermes, we&#8217;ll write the weak
formulation as:</p>
<div class="math">
<p><img src="../../images/math/6aeab354ed92be6b35a047e039a3c43727ddf5d6.png" alt="B_{00}(w_0, \varphi^0) + B_{01}(w_1, \varphi^0) +
    B_{03}(w_3, \varphi^0)+ B_{04}(w_4, \varphi^0) = l_0(\varphi^0)

B_{10}(w_0, \varphi^1) + B_{11}(w_1, \varphi^1) +
    B_{13}(w_3, \varphi^1)+ B_{14}(w_4, \varphi^1) = l_1(\varphi^1)

B_{30}(w_0, \varphi^3) + B_{31}(w_1, \varphi^3) +
    B_{33}(w_3, \varphi^3)+ B_{34}(w_4, \varphi^3) = l_3(\varphi^3)

B_{40}(w_0, \varphi^4) + B_{41}(w_1, \varphi^4) +
    B_{43}(w_3, \varphi^4)+ B_{44}(w_4, \varphi^4) = l_4(\varphi^4)" /></p>
</div><p>where the forms are (we write <img class="math" src="../../images/math/535b2bfbb0a587e261a0d0af9b7b53e42629b14d.png" alt="w_i"/> instead of <img class="math" src="../../images/math/9881757570bbbc448cfa593b5b536968fe73748e.png" alt="w_i^{n+1}"/>):</p>
<div class="math">
<p><img src="../../images/math/c5df7e9c738dfec7d35298283849e59974280eca.png" alt="l_0(\varphi^0) = \int_\Omega {w_0^n\varphi^0\over\tau} \,\d^2 x

l_1(\varphi^1) = \int_\Omega {w_1^n\varphi^1\over\tau} \,\d^2 x

l_3(\varphi^3) = \int_\Omega {w_3^n\varphi^3\over\tau} + \rho g \varphi^3
    \,\d^2 x

l_4(\varphi^4) = \int_\Omega {w_4^n\varphi^4\over\tau} \,\d^2 x

B_{ij}(w_j, \varphi^i) = \int_{\Omega} {w_i\over\tau}\varphi^i
    \delta_{ij}
    - \left({\bf A}_x({\bf w}^n)\right)_{ij}
      w_j {\partial \varphi^i\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{ij}
      w_j {\partial \varphi^i\over\partial z}
    \ \d^2 x" /></p>
</div><p>In the last expression we do <em>not</em> sum over <img class="math" src="../../images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/> nor <img class="math" src="../../images/math/8122aa89ea6e80784c6513d22787ad86e36ad0cc.png" alt="j"/>.
In particular:</p>
<div class="math">
<p><img src="../../images/math/8c5aef1a9a7ac4189a094307fa8905a5b1cb76c0.png" alt="B_{00}(w_0, \varphi^0) = \int_{\Omega} {w_0\over\tau}\varphi^0
    - \left({\bf A}_x({\bf w}^n)\right)_{00}
      w_0 {\partial \varphi^0\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{00}
      w_0 {\partial \varphi^0\over\partial z}
    \ \d^2 x
    =
    \int_{\Omega} {w_0\over\tau}\varphi^0
    \ \d^2 x

B_{01}(w_1, \varphi^0) = \int_{\Omega}
    - \left({\bf A}_x({\bf w}^n)\right)_{01}
      w_1 {\partial \varphi^0\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{01}
      w_1 {\partial \varphi^0\over\partial z}
    \ \d^2 x
    =
    \int_{\Omega}
    - \left({\bf A}_x({\bf w}^n)\right)_{01}
      w_1 {\partial \varphi^0\over\partial x}
    \ \d^2 x

B_{03}(w_3, \varphi^0) = \int_{\Omega}
    - \left({\bf A}_x({\bf w}^n)\right)_{03}
      w_3 {\partial \varphi^0\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{03}
      w_3 {\partial \varphi^0\over\partial z}
    \ \d^2 x
    =
    \int_{\Omega}
    - \left({\bf A}_z({\bf w}^n)\right)_{03}
      w_3 {\partial \varphi^0\over\partial z}
    \ \d^2 x

B_{04}(w_4, \varphi^0) = \int_{\Omega}
    - \left({\bf A}_x({\bf w}^n)\right)_{04}
      w_4 {\partial \varphi^0\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{04}
      w_4 {\partial \varphi^0\over\partial z}
    \ \d^2 x
    =0

B_{10}(w_0, \varphi^1) = \int_{\Omega}
    - \left({\bf A}_x({\bf w}^n)\right)_{10}
      w_0 {\partial \varphi^1\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{10}
      w_0 {\partial \varphi^1\over\partial z}
    \ \d^2 x

B_{11}(w_1, \varphi^1) = \int_{\Omega} {w_1\over\tau}\varphi^1
    - \left({\bf A}_x({\bf w}^n)\right)_{11}
      w_1 {\partial \varphi^1\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{11}
      w_1 {\partial \varphi^1\over\partial z}
    \ \d^2 x

\cdots" /></p>
</div></div>
</div>
<div class="section" id="boundary-conditions">
<h2>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">Â¶</a></h2>
<p>In the boundary (line) integral we prescribe <img class="math" src="../../images/math/ae00070d200230a6436b15a83d721acd675e9ed6.png" alt="w_4^{n+1}"/> using a Dirichlet
condition and calculate it at each iteration using:</p>
<div class="math">
<p><img src="../../images/math/8e3da0501d6b7177d5a1664116599ffa4ce482ae.png" alt="w_4^{n+1} = E = \rho T c_v + \half \rho u^2 = w_0 T c_v +
    {w_1^2+w_3^2\over 2w_0}" /></p>
</div><p>where <img class="math" src="../../images/math/03495b3b1b09ec4c6247d56444917a48b790936c.png" alt="T(t)"/> is a known function of time (it changes with the day and night)
and also prescribe <img class="math" src="../../images/math/581fa65e732777ecfda03d46ec11288dbe036f72.png" alt="w_1^{n+1}=0"/> on the left and right end of the domain and
<img class="math" src="../../images/math/1c53b972e09d391c406908b53fe1e3f2bac2f311.png" alt="w_3^{n+1}=0"/> at the top and bottom.</p>
<p>All the surface integrals turn out to be zero. On the top and bottom edges we
have <img class="math" src="../../images/math/0088eaa7c6a2477e4d029fc69a3a5417732a3515.png" alt="{\bf n} = (n_x, n_z) = (0, \pm 1)"/> respectively and we prescribe <img class="math" src="../../images/math/420029ad605dbaa8f7ce8411f891e77a71bf2dd9.png" alt="w_3=0"/>,
so we get (remember we do not sum over <img class="math" src="../../images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>):</p>
<div class="math">
<p><img src="../../images/math/04c751e5f6fa48e76034ff2374fffa31a2e4bf2c.png" alt="\int_{\partial\Omega}
\left({\bf A}_x({\bf w}^n)\right)_{ij}w_j
    \varphi^i\, n_x
+ \left({\bf A}_z({\bf w}^n)\right)_{ij}w_j
    \varphi^i\, n_z
\ \d x
=

=
\int_{\partial\Omega}
\left({\bf f}_x({\bf w}^n)\right)_i
    \varphi^i\, n_x
+ \left({\bf f}_z({\bf w}^n)\right)_i
    \varphi^i\, n_z
\ \d x
=

=
\pm\int_{\partial\Omega}
\left({\bf f}_z({\bf w}^n)\right)_i
    \varphi^i
\ \d x" /></p>
</div><p>where:</p>
<div class="math">
<p><img src="../../images/math/194c294f5b96a903298ba2f1b7db5b6cf2ad6c24.png" alt="{\bf f}_z =
   \left( \begin{array}{c}
       w_3\\
       \frac{w_3w_1}{w_0}\\
       \frac{w_3^2}{w_0} + p\\
       \frac{w_3}{w_0}(w_4+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       0\\
       0\\
       p\\
       0
   \end{array} \right)" /></p>
</div><p>So all the components <img class="math" src="../../images/math/ac2672e1a8c8ecccb025d7840b91c293baa618f1.png" alt="i\neq 3"/> of the surface integral are zero, and for <img class="math" src="../../images/math/a4566e11dab22bafa7c82220f54e440ef4437ff3.png" alt="i=3"/>
the test function <img class="math" src="../../images/math/2934a49b0a0783f5c9d10777cb991b3715934e8d.png" alt="\varphi^3"/> is not there, because we prescribe the Dirichlet
BC <img class="math" src="../../images/math/f77f46122a46795b6d010537b8f797ac319f46b2.png" alt="w^3=0"/>, so the surface integral vanishes for all <img class="math" src="../../images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>.</p>
<p>Similarly on the left and right edges we
have <img class="math" src="../../images/math/39ab6de4922010a27dcdd8a9319263d5acf91da6.png" alt="{\bf n} = (n_x, n_z) = (\pm1, 0)"/> respectively and we prescribe <img class="math" src="../../images/math/b83c811471a225edd7c39a99941731be34f6dfc6.png" alt="w_1=0"/>,
so we get (remember we do not sum over <img class="math" src="../../images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>):</p>
<div class="math">
<p><img src="../../images/math/6951e7957be73f10617808c39a18f6518dd865b5.png" alt="\int_{\partial\Omega}
\left({\bf A}_x({\bf w}^n)\right)_{ij}w_j
    \varphi^i\, n_x
+ \left({\bf A}_z({\bf w}^n)\right)_{ij}w_j
    \varphi^i\, n_z
\ \d x
=

=
\int_{\partial\Omega}
\left({\bf f}_x({\bf w}^n)\right)_i
    \varphi^i\, n_x
+ \left({\bf f}_z({\bf w}^n)\right)_i
    \varphi^i\, n_z
\ \d x
=

=
\pm\int_{\partial\Omega}
\left({\bf f}_x({\bf w}^n)\right)_i
    \varphi^i
\ \d x" /></p>
</div><p>where:</p>
<div class="math">
<p><img src="../../images/math/6268351fd21d14de846bfff433372cc5d690f80f.png" alt="{\bf f}_x =
   \left( \begin{array}{c}
       w_1\\
       \frac{w_1^2}{w_0} + p\\
       \frac{w_1w_3}{w_0}\\
       \frac{w_1}{w_0}(w_4+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       0\\
       p\\
       0\\
       0
   \end{array} \right)" /></p>
</div><p>So all the components <img class="math" src="../../images/math/16ab72a216b4eca45191b1e7ce387106054a50e8.png" alt="i\neq 1"/> of the surface integral are zero, and for <img class="math" src="../../images/math/50ed4b89a6aeb4814026a2be01bde8bd7d264b71.png" alt="i=1"/>
the test function <img class="math" src="../../images/math/1e96a4ba79a4820a81ebde8c109ba0ea3aba296a.png" alt="\varphi^1"/> is not there, because we prescribe the Dirichlet
BC <img class="math" src="../../images/math/a1465f1b6e0f5aaf7e71db9e688b7a465b0491db.png" alt="w^1=0"/>, so the surface integral vanishes for all <img class="math" src="../../images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>.</p>
<div class="section" id="older-notes">
<h3>Older notes<a class="headerlink" href="#older-notes" title="Permalink to this headline">Â¶</a></h3>
<p>Author: Pavel Solin</p>
</div>
</div>
<div class="section" id="governing-equations-and-boundary-conditions">
<h2>Governing Equations and Boundary Conditions<a class="headerlink" href="#governing-equations-and-boundary-conditions" title="Permalink to this headline">Â¶</a></h2>
<div class="math" id="equation-one">
<p><span class="eqno">(1)</span><img src="../../images/math/84910087e1617188944538f5d757c90d81fc5785.png" alt="\frac{\partial}{\partial t} \left( \begin{array}{c} \varrho\\ U\\ W\\
   \theta \end{array} \right) + \frac{\partial}{\partial x} \left(
   \begin{array}{c} U\\ \frac{U^2}{\varrho} + R\theta\\
   \frac{UW}{\varrho}\\ \frac{\theta U}{\varrho} \end{array} \right) +
   \frac{\partial}{\partial z} \left( \begin{array}{c} W\\
   \frac{UW}{\varrho}\\ \frac{W^2}{\varrho} + R\theta\\ \frac{\theta
   W}{\varrho} \end{array} \right) + \left( \begin{array}{c} 0\\ 0\\
   \varrho g\\ \frac{R\theta}{c_v}\mbox{div}{\bf v} \end{array} \right) =
   \left( \begin{array}{c} 0\\ 0\\ 0\\ 0 \end{array} \right)," /></p>
</div><p>where <img class="math" src="../../images/math/e7fe4fc87a1b38d0b6f1f34da3c84a3fd3cb64c6.png" alt="\varrho"/> is the air density, <img class="math" src="../../images/math/87fa0e09e02d0d3cc96225398eb8850c3f1c7fd6.png" alt="{\bf v} = (u,w)"/> is the velocity, <img class="math" src="../../images/math/61674d0577c296d0ed7f1cc23e172a57edf53359.png" alt="U =
\varrho u"/>, <img class="math" src="../../images/math/55a73be8b9941ee57f23caef9446c140de378265.png" alt="W = \varrho w"/>, <img class="math" src="../../images/math/2554b6496c3b678897e9b060ef00aa9f0a7d7ece.png" alt="T"/> is the temperature, <img class="math" src="../../images/math/99a3bc63af573497d219fecea2ca37f2e3a20aa0.png" alt="\theta = \varrho T"/>, and
<img class="math" src="../../images/math/311cabda3a9b09f0dde217303ca9d1cd9201dcf6.png" alt="g"/> is the gravitational acceleration constant.  We use the perfect gas state
equation <img class="math" src="../../images/math/006343386334ce6bcdfad73d55ae1b3a60cf0ccd.png" alt="p = \varrho R T = R \theta"/> for the pressure.</p>
<p>Boundary conditions are prescribed as follows:</p>
<ul class="simple">
<li>edge <img class="math" src="../../images/math/c7d457e388298246adb06c587bccd419ea67f7e8.png" alt="a"/>: <img class="math" src="../../images/math/6cb80fe754c6dfa660a36f4a57196463bae3955c.png" alt="\partial \varrho / \partial \nu = 0"/>, <img class="math" src="../../images/math/d0699a49e53c981f14be767867e4e1a089867618.png" alt="\partial U / \partial \nu = 0"/>, <img class="math" src="../../images/math/d4ed02db4183787cd4b4756285f255e4a8fba0e3.png" alt="W = 0"/>, <img class="math" src="../../images/math/259d735eb5a364c387c84fe64a49db4dd1c6a4ca.png" alt="\theta = \mbox{tanh}(x)*\mbox{sin}(\pi t /86400)"/></li>
<li>edges <img class="math" src="../../images/math/8c9b1452aab72a3897a7921688449e11bf3dff28.png" alt="b, c"/>: <img class="math" src="../../images/math/6cb80fe754c6dfa660a36f4a57196463bae3955c.png" alt="\partial \varrho / \partial \nu = 0"/>, <img class="math" src="../../images/math/f822bdbce36011ce7b7af7ccd327c4388c9e313a.png" alt="U = 0"/>, <img class="math" src="../../images/math/1c6d4b32aae386bd12f81f49dfcc6fcd2f3b7a20.png" alt="\partial W / \partial \nu = 0"/>, <img class="math" src="../../images/math/52e6e9517ebf15977d5c5c77e3b8304d19cb4664.png" alt="\partial \theta/ \partial \nu = 0"/></li>
<li>edge <img class="math" src="../../images/math/96ab646de7704969b91c76a214126b45f2b07b25.png" alt="d"/>: <img class="math" src="../../images/math/6cb80fe754c6dfa660a36f4a57196463bae3955c.png" alt="\partial \varrho / \partial \nu = 0"/>, <img class="math" src="../../images/math/d0699a49e53c981f14be767867e4e1a089867618.png" alt="\partial U / \partial \nu = 0"/>, <img class="math" src="../../images/math/d4ed02db4183787cd4b4756285f255e4a8fba0e3.png" alt="W = 0"/>, <img class="math" src="../../images/math/52e6e9517ebf15977d5c5c77e3b8304d19cb4664.png" alt="\partial \theta/ \partial \nu = 0"/></li>
</ul>
<p>Initial conditions have the form</p>
<div class="math">
<p><img src="../../images/math/241829fb9bf6b59f3dc315f268f4614dd7ae021d.png" alt="\begin{eqnarray*} p(z) &amp;=&amp; p_0 - 11476\frac{z}{1000}  + 529.54 \left(\frac{z}{1000} \right)^2 - 9.38 \left(\frac{z}{1000} \right)^3,\\ T(z) &amp;=&amp; T_0 - 8.3194 \frac{z}{1000} + 0.2932 \left(\frac{z}{1000} \right)^2 - 0.0109 \left(\frac{z}{1000} \right)^3,\\ \varrho(z) &amp;=&amp; \frac{p(z)}{R T(z)},\\ \theta(z) &amp;=&amp; \varrho(z)T(z),\\ U(z) &amp;=&amp; 0, \\  W(z) &amp;=&amp; 0. \end{eqnarray*}" /></p>
</div></div>
<div class="section" id="discretization-and-the-newton-s-method">
<h2>Discretization and the Newton&#8217;s Method<a class="headerlink" href="#discretization-and-the-newton-s-method" title="Permalink to this headline">Â¶</a></h2>
<p>We will use the implicit Euler method in time, i.e.,</p>
<div class="math">
<p><img src="../../images/math/9f8c7a43f132f7cc976ddc8438fa584d4d4f835b.png" alt="\frac{\partial \varrho}{\partial t} \approx \frac{\varrho^{n+1} - \varrho^n}{\tau}" /></p>
</div><p>etc. Let&#8217;s discuss one equation of <a href="#equation-one">(1)</a> at a time:</p>
<p><cite>Continuity equation</cite>:
The weak formulation of</p>
<div class="math">
<p><img src="../../images/math/4707dce66688218c2d2a9b0fbea231d7ab2f1eec.png" alt="\frac{\varrho^{n+1} - \varrho^n}{\tau} + \frac{\partial U^{n+1}}{\partial x} + \frac{\partial W^{n+1}}{\partial z} = 0" /></p>
</div><p>reads</p>
<div class="math" id="equation-cont">
<p><span class="eqno">(2)</span><img src="../../images/math/a6fd7af7049ddc562ff0e4f62334625f2448d15b.png" alt="F_i^{\varrho}(Y^{n+1}) = \int_{\Omega} \frac{\varrho^{n+1}}{\tau}
\varphi^{\varrho}_i
- \int_{\Omega} \frac{\varrho^{n}}{\tau} \varphi^{\varrho}_i
  + \int_{\Omega} \frac{\partial U^{n+1}}{\partial x} \varphi^{\varrho}_i
    + \int_{\Omega} \frac{\partial W^{n+1}}{\partial z} \varphi^{\varrho}_i = 0" /></p>
</div><p>The global coefficient vector <img class="math" src="../../images/math/56261d82e783c9407fd48363dc4b78473da85b99.png" alt="Y^{n+1}"/> consists of four parts <img class="math" src="../../images/math/eb7db6f57badbdb64fb8fc4a7e2c020fc87a17d2.png" alt="Y^{\varrho}"/>, <img class="math" src="../../images/math/87ab5595e0f587c4dfdd5e50ff2de4c7cfbf6fae.png" alt="Y^{U}"/>, <img class="math" src="../../images/math/33e3570558a112c849285e6b6e85765b1ec95995.png" alt="Y^{W}"/>
and <img class="math" src="../../images/math/a291318ca6b35df3736f2d34893d4c83d27c59bd.png" alt="Y^{\theta}"/> corresponding to the fields <img class="math" src="../../images/math/e7fe4fc87a1b38d0b6f1f34da3c84a3fd3cb64c6.png" alt="\varrho"/>, <img class="math" src="../../images/math/e2bbebb3bd73f1ae5c64098ab0244f739abf7ca4.png" alt="U"/>, <img class="math" src="../../images/math/10cb764f88509fb1c8012366993fdbee98f31bc5.png" alt="W"/> and <img class="math" src="../../images/math/52e8ed7a3ba22130ad3984eb2cd413406475a689.png" alt="\theta"/>, respectively.
The same holds for the vector function <img class="math" src="../../images/math/a055f405829e64a3b70253ab67cb45ed6ed5bb29.png" alt="F"/> which consists of four parts <img class="math" src="../../images/math/fca9492caabae6de933463451e1cd5d4cd1838de.png" alt="F^{\varrho}"/>, <img class="math" src="../../images/math/323b03c4e39800cc407cc8ad31cf288cd0603940.png" alt="F^{U}"/>, <img class="math" src="../../images/math/0652fc66a530ad4d7b2b44d75fd7ff1d9184a5f7.png" alt="F^{W}"/>
and <img class="math" src="../../images/math/f87ec54913ce4edb6b0705a8a9e4c75b43f6fed0.png" alt="F^{\theta}"/>. Thus the global Jacobi matrix will have a four-by-four block structure. We
denote</p>
<div class="math" id="equation-two">
<p><span class="eqno">(3)</span><img src="../../images/math/14df39249e67c08adfdecfa5f375f6522e690e94.png" alt="\varrho^{n+1} = \sum_{k=1}^{N^{\varrho}} y^{\varrho}_k \varphi^{\varrho}_k, \ \
\
U^{n+1} = \sum_{k=1}^{N^{U}} y^{U}_k \varphi^{U}_k, \ \ \
W^{n+1} = \sum_{k=1}^{N^{W}} y^{W}_k \varphi^{W}_k, \ \ \
\theta^{n+1} = \sum_{k=1}^{N^{\theta}} y^{\theta}_k \varphi^{\theta}_k." /></p>
</div><p>It follows from <a href="#equation-cont">(2)</a> and <a href="#equation-two">(3)</a> that</p>
<div class="math">
<p><img src="../../images/math/20b6654c05d4f49c306e032dcccb520c23a2a18f.png" alt="\frac{\partial F^{\varrho}_i}{\partial y^{\varrho}_j} = \int_{\Omega} \frac{\varphi^{\varrho}_j}{\tau} \varphi^{\varrho}_i, \ \ \ \frac{\partial F^{\varrho}_i}{\partial y^{U}_j} = \int_{\Omega} \frac{\partial \varphi^{U}_j}{\partial x} \varphi^{\varrho}_i, \ \ \ \frac{\partial F^{\varrho}_i}{\partial y^{W}_j} = \int_{\Omega} \frac{\partial \varphi^{W}_j}{\partial z} \varphi^{\varrho}_i, \ \ \ \frac{\partial F^{\varrho}_i}{\partial y^{W}_j} = 0." /></p>
</div><p><cite>First momentum equation</cite>: The second equation of <a href="#equation-one">(1)</a> has the form</p>
<div class="math">
<p><img src="../../images/math/33cb83966ed9529e8a35af88ad3a01f90044dc3c.png" alt="\frac{\partial U}{\partial t} + \frac{2U}{\varrho}\frac{\partial U}{\partial x}  - \frac{U^2}{\varrho^2} \frac{\partial \varrho}{\partial x} + R\frac{\partial \theta}{\partial x} + \frac{W}{\varrho}\frac{\partial U}{\partial z} + \frac{U}{\varrho}\frac{\partial W}{\partial z} - \frac{UW}{\varrho^2}\frac{\partial \varrho}{\partial z} = 0." /></p>
</div><p>After applying the implicit Euler method, we obtain</p>
<div class="math">
<p><img src="../../images/math/06c77e692cd600a13ed2975f611bfcb341ad0e42.png" alt="\frac{\partial U^{n+1}}{\tau} - \frac{\partial U^{n}}{\tau} + \frac{2U^{n+1}}{\varrho^{n+1}}\frac{\partial U^{n+1}}{\partial x}  - \frac{(U^{n+1})^2}{(\varrho^{n+1})^2} \frac{\partial \varrho^{n+1}}{\partial x} + R\frac{\partial \theta^{n+1}}{\partial x}" /></p>
</div><div class="math">
<p><img src="../../images/math/ba015ce6c73b09d41c420a7f117fa92e77eb2166.png" alt="+ \frac{W^{n+1}}{\varrho^{n+1}}\frac{\partial U^{n+1}}{\partial z} + \frac{U^{n+1}}{\varrho^{n+1}}\frac{\partial W^{n+1}}{\partial z} - \frac{U^{n+1}W^{n+1}}{(\varrho^{n+1})^2}\frac{\partial \varrho^{n+1}}{\partial z} = 0." /></p>
</div><p>Thus we obtain</p>
<div class="math">
<p><img src="../../images/math/5d90d16e21dfbf3a6741ef8ef79e4f97a0869b2e.png" alt="\frac{\partial F^{U}_i}{\partial y^{\varrho}_j} =  - \int_{\Omega}\frac{2U}{\varrho^2}\frac{\partial U}{\partial x} \varphi^{\varrho}_j \varphi^{U}_i  -  \int_{\Omega} U^2 \left[(-2)\frac{1}{\varrho^3}\frac{\partial \varrho}{\partial x} \varphi^{\varrho}_j  + \frac{1}{\varrho^2}\frac{\partial \varphi^{\varrho}_j}{\partial x}\right] \varphi^U_i" /></p>
</div><div class="math">
<p><img src="../../images/math/05ee7307d6b8ab4999e104ea8d7708a17dbcaa1b.png" alt="+ \int_{\Omega} \frac{W}{\varrho^2}\frac{\partial U}{\partial z}(-1)\varphi^{\varrho}_j \varphi^U_i + \int_{\Omega} \frac{U}{\varrho^2}\frac{\partial W}{\partial z}(-1)\varphi^{\varrho}_j \varphi^U_i - \int_{\Omega} UW \left[(-2)\frac{1}{\varrho^3}\frac{\partial \varrho}{\partial z} \varphi^{\varrho}_j + \frac{1}{\varrho^2}\frac{\partial \varphi^{\varrho}_j}{\partial z} \right] \varphi^{U}_i." /></p>
</div><p>Analogously,</p>
<div class="math">
<p><img src="../../images/math/b8699582395cf5566bcf10c9e90bfb7f12b9a61a.png" alt="\frac{\partial F^{U}_i}{\partial y^{U}_j} =  \int_{\Omega}\frac{\varphi^U_j}{\tau}\varphi^U_i + \int_{\Omega}\frac{2}{\varrho} \left[ \frac{\partial U}{\partial x}\varphi^U_j + U \frac{\partial \varphi^U_j}{\partial x} \right] \varphi^U_i - \int_{\Omega} \frac{2U}{\varrho^2}\frac{\partial \varrho}{\partial x} \varphi^U_j \varphi^U_i" /></p>
</div><div class="math">
<p><img src="../../images/math/57045db9d573d34f04bb5301bc3dcfaf50feb759.png" alt="+ \int_{\Omega} \frac{W}{\varrho}\frac{\partial \varphi^U_j}{\partial z} \varphi^U_i  + \int_{\Omega} \frac{1}{\varrho}\frac{\partial W}{\partial z} \varphi^U_j \varphi^U_i  - \int_{\Omega} \frac{W}{\varrho^2}\frac{\partial \varrho}{\partial z} \varphi^U_j \varphi^U_i," /></p>
</div><div class="math">
<p><img src="../../images/math/cc8b01a1baae61f322f7fcf422514171aee7b023.png" alt="\frac{\partial F^{U}_i}{\partial y^{W}_j} =  \int_{\Omega} \frac{1}{\varrho}\frac{\partial U}{\partial z} \varphi^W_j \varphi^U_i + \int_{\Omega} \frac{U}{\varrho}\frac{\partial \varphi^W_j}{\partial z} \varphi^U_i - \int_{\Omega} \frac{U}{\varrho^2}\frac{\partial \varrho}{\partial z} \varphi^W_j \varphi^U_i," /></p>
</div><div class="math">
<p><img src="../../images/math/c1626ae12542c0fd5103c4029b83b93d85818995.png" alt="\frac{\partial F^{U}_i}{\partial y^{\theta}_j} =  \int_{\Omega} R \frac{\partial \varphi^{\theta}_j}{\partial x} \varphi^U_i." /></p>
</div><p><cite>Second momentum equation</cite>: The third equation of <a href="#equation-one">(1)</a> reads</p>
<div class="math">
<p><img src="../../images/math/7da88d263f3b665872ad66e10e2cb66586fd84d6.png" alt="\frac{\partial W}{\partial t}  + \frac{W}{\varrho}\frac{\partial U}{\partial x} + \frac{U}{\varrho}\frac{\partial W}{\partial x} - \frac{UW}{\varrho^2}\frac{\partial \varrho}{\partial x}  + \frac{2W}{\varrho}\frac{\partial W}{\partial z}  - \frac{W^2}{\varrho^2} \frac{\partial \varrho}{\partial x} + R\frac{\partial \theta}{\partial z} + \varrho g= 0." /></p>
</div><p>After applying the implicit Euler method, we obtain</p>
<div class="math">
<p><img src="../../images/math/307aaf82ac6672ce67d39601300c382aa9466d58.png" alt="\frac{\partial W^{n+1}}{\tau} - \frac{\partial W^{n}}{\tau}  + \frac{W^{n+1}}{\varrho^{n+1}}\frac{\partial U^{n+1}}{\partial x} + \frac{U^{n+1}}{\varrho^{n+1}}\frac{\partial W^{n+1}}{\partial x} - \frac{U^{n+1}W^{n+1}}{(\varrho^{n+1})^2}\frac{\partial \varrho^{n+1}}{\partial x}" /></p>
</div><div class="math">
<p><img src="../../images/math/1fa73e8b0beb2660782fe6124e1a3e37af00e616.png" alt="+ \frac{2W^{n+1}}{\varrho^{n+1}}\frac{\partial W^{n+1}}{\partial z}  - \frac{(W^{n+1})^2}{(\varrho^{n+1})^2} \frac{\partial \varrho^{n+1}}{\partial x} + R\frac{\partial \theta^{n+1}}{\partial z} + \varrho^{n+1} g= 0." /></p>
</div><p>Thus we obtain</p>
<div class="math">
<p><img src="../../images/math/c534b798c6789f9cabc77da40d12b4e17e181366.png" alt="\frac{\partial F^{W}_i}{\partial y^{\varrho}_j} =  + \int_{\Omega} \frac{W}{\varrho^2}\frac{\partial U}{\partial x}(-1)\varphi^{\varrho}_j \varphi^W_i + \int_{\Omega} \frac{U}{\varrho^2}\frac{\partial W}{\partial x}(-1)\varphi^{\varrho}_j \varphi^W_i - \int_{\Omega}\frac{2W}{\varrho^2}\frac{\partial W}{\partial x} \varphi^{\varrho}_j \varphi^{W}_i" /></p>
</div><div class="math">
<p><img src="../../images/math/ccaea5d0d618e61561383df8afc48884925cf459.png" alt="- \int_{\Omega} UW \left[(-2)\frac{1}{\varrho^3}\frac{\partial \varrho}{\partial x} \varphi^{\varrho}_j  + \frac{1}{\varrho^2}\frac{\partial \varphi^{\varrho}_j}{\partial x} \right] \varphi^{W}_i -  \int_{\Omega} W^2 \left[(-2)\frac{1}{\varrho^3}\frac{\partial \varrho}{\partial z} \varphi^{\varrho}_j  + \frac{1}{\varrho^2}\frac{\partial \varphi^{\varrho}_j}{\partial z}\right] \varphi^W_i  + \int_{\Omega}g \varphi^{\varrho}_j \varphi^{W}_i." /></p>
</div><p>Analogously,</p>
<div class="math">
<p><img src="../../images/math/a4d7facaea588881e37d9c27707a3d11ed8fe4bf.png" alt="\frac{\partial F^{W}_i}{\partial y^{U}_j} =  \int_{\Omega} \frac{W}{\varrho}\frac{\partial \varphi^U_j}{\partial x} \varphi^W_i + \int_{\Omega} \frac{1}{\varrho}\frac{\partial W}{\partial x} \varphi^U_j \varphi^W_i - \int_{\Omega} \frac{W}{\varrho^2}\frac{\partial \varrho}{\partial x} \varphi^U_j \varphi^W_i," /></p>
</div><div class="math">
<p><img src="../../images/math/36da6e4eb2af16d5cd8a95f1cdb76b043e449e2d.png" alt="\frac{\partial F^{W}_i}{\partial y^{W}_j} =  \int_{\Omega}\frac{\varphi^W_j}{\tau}\varphi^W_i + \int_{\Omega} \frac{1}{\varrho}\frac{\partial U}{\partial x} \varphi^W_j \varphi^W_i  + \int_{\Omega} \frac{U}{\varrho}\frac{\partial \varphi^W_j}{\partial x} \varphi^W_i  - \int_{\Omega} \frac{U}{\varrho^2}\frac{\partial \varrho}{\partial x} \varphi^W_j \varphi^W_i" /></p>
</div><div class="math">
<p><img src="../../images/math/3ac10c20dfc5194ca78cb17fa77188cac386acda.png" alt="+ \int_{\Omega}\frac{2}{\varrho} \left[ \frac{\partial W}{\partial z}\varphi^W_j + W \frac{\partial \varphi^W_j}{\partial z} \right] \varphi^W_i  - \int_{\Omega} \frac{2W}{\varrho^2}\frac{\partial \varrho}{\partial z} \varphi^W_j \varphi^W_i," /></p>
</div><div class="math">
<p><img src="../../images/math/9777eca4c3eb7b92fd3c6007614e7ee4ef92d9b1.png" alt="\frac{\partial F^{W}_i}{\partial y^{\theta}_j} =  \int_{\Omega} R \frac{\partial \varphi^{\theta}_j}{\partial z} \varphi^W_i." /></p>
</div><p><cite>Internal energy equation</cite>: The last equation of <a href="#equation-one">(1)</a> has the form</p>
<div class="math">
<p><img src="../../images/math/9cbd5a3ad1a9ca17ad3233b7728ed5acc91798e4.png" alt="\frac{\partial \theta}{\partial t} + \mbox{div}(\theta {\bf v}) + \frac{R
\theta}{c_v} \mbox{div}{\bf v} = 0" /></p>
</div><p>where <img class="math" src="../../images/math/99a3bc63af573497d219fecea2ca37f2e3a20aa0.png" alt="\theta = \varrho T"/>. This can be written equivalently as</p>
<div class="math">
<p><img src="../../images/math/68a611fafdc16eb74de89499dd4b31c66c157e15.png" alt="\frac{\partial \theta}{\partial t} + \nabla \theta \cdot {\bf v} + \gamma
\theta \mbox{div} {\bf v} = 0." /></p>
</div><p>Written in terms of single derivatives, this is</p>
<div class="math">
<p><img src="../../images/math/8a72905cd1cf1e4ebaba9e4d35fed3cb364172e9.png" alt="\frac{\partial \theta}{\partial t} + \frac{\partial \theta}{\partial x} \frac{U}{\varrho} + \frac{\partial \theta}{\partial z} \frac{W}{\varrho}  + \gamma \theta \frac{\partial}{\partial x}\left(\frac{U}{\varrho}  \right) + \gamma \theta \frac{\partial}{\partial z}\left(\frac{W}{\varrho}  \right) = 0," /></p>
</div><p>i.e.,</p>
<div class="math">
<p><img src="../../images/math/35345c221685f7861a71c3e9d0a71d9ce9322c26.png" alt="\frac{\partial \theta}{\partial t}  + \frac{\partial \theta}{\partial x} \frac{U}{\varrho} + \frac{\partial \theta}{\partial z} \frac{W}{\varrho}  + \gamma \frac{\theta}{\varrho} \frac{\partial U}{\partial x} - \gamma \frac{\theta U}{\varrho^2}\frac{\partial \varrho}{\partial x} + \gamma \frac{\theta}{\varrho} \frac{\partial W}{\partial z} - \gamma \frac{\theta W}{\varrho^2}\frac{\partial \varrho}{\partial z} = 0." /></p>
</div><p><cite>Weak formulation</cite>:</p>
<div class="math">
<p><img src="../../images/math/a1d46ecdf154632b674ef5f6e9b1377fcd0ac820.png" alt="F^{\theta}_i(Y) =  \int_{\Omega} \frac{\theta^{n+1}}{\tau} \varphi^{\theta}_i - \int_{\Omega} \frac{\theta^{n}}{\tau} \varphi^{\theta}_i + \int_{\Omega} \frac{\partial \theta^{n+1}}{\partial x} \frac{U^{n+1}}{\varrho^{n+1}}\varphi^{\theta}_i + \int_{\Omega} \frac{\partial \theta^{n+1}}{\partial z} \frac{W^{n+1}}{\varrho^{n+1}} \varphi^{\theta}_i" /></p>
</div><div class="math">
<p><img src="../../images/math/e586303277cfa7728aba8595befbcdc4d48c4d29.png" alt="+ \int_{\Omega} \gamma \frac{\theta^{n+1}}{\varrho^{n+1}} \frac{\partial U^{n+1}}{\partial x}\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta^{n+1} U^{n+1}}{(\varrho^{n+1})^2}\frac{\partial \varrho^{n+1}}{\partial x}\varphi^{\theta}_i + \int_{\Omega} \gamma \frac{\theta^{n+1}}{\varrho^{n+1}} \frac{\partial W^{n+1}}{\partial z}\varphi^{\theta}_i -\int_{\Omega}  \gamma \frac{\theta^{n+1} W^{n+1}}{(\varrho^{n+1})^2}\frac{\partial \varrho^{n+1}}{\partial z} \varphi^{\theta}_i= 0." /></p>
</div><p>For the derivatives of the weak form we obtain:</p>
<div class="math">
<p><img src="../../images/math/7588d3eaaa984152f77d474fce78b3142154fea1.png" alt="\frac{\partial F^{\theta}_i}{\partial y^{\varrho}_j} =  - \int_{\Omega} \frac{\partial \theta}{\partial x} \frac{U}{\varrho^2}\varphi^{\varrho}_j\varphi^{\theta}_i - \int_{\Omega} \frac{\partial \theta}{\partial z} \frac{W}{\varrho^2}\varphi^{\varrho}_j\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta}{\varrho^2} \frac{\partial U}{\partial x}\varphi^{\varrho}_j\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta}{\varrho^2} \frac{\partial W}{\partial z}\varphi^{\varrho}_j\varphi^{\theta}_i" /></p>
</div><div class="math">
<p><img src="../../images/math/068e40fd96502bc810e45763ad1c3ab98a34ae5a.png" alt="+ \int_{\Omega} 2\gamma \frac{\theta U}{\varrho^3}\frac{\partial \varrho}{\partial x}\varphi^{\varrho}_j\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta U}{\varrho^2}\frac{\varphi^{\varrho}_j}{\partial x}\varphi^{\theta}_i + \int_{\Omega} 2\gamma \frac{\theta W}{\varrho^3}\frac{\partial \varrho}{\partial z}\varphi^{\varrho}_j\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta W}{\varrho^2}\frac{\varphi^{\varrho}_j}{\partial z}\varphi^{\theta}_i." /></p>
</div><div class="math">
<p><img src="../../images/math/ad4b4e4b96bf5be1fd987e1df488f86ef1389de5.png" alt="\frac{\partial F^{\theta}_i}{\partial y^{U}_j} =  \int_{\Omega} \frac{\partial \theta}{\partial x} \frac{1}{\varrho} \varphi^{U}_j\varphi^{\theta}_i + \int_{\Omega} \gamma \frac{\theta}{\varrho}\frac{\varphi^{U}_j}{\partial x}\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta}{\varrho^2}\frac{\partial \varrho}{\partial x}\varphi^{U}_j\varphi^{\theta}_i." /></p>
</div><div class="math">
<p><img src="../../images/math/c0a39203e69ec3706c7e32795f21e62418dd42b7.png" alt="\frac{\partial F^{\theta}_i}{\partial y^{W}_j} =  \int_{\Omega} \frac{\partial \theta}{\partial z} \frac{1}{\varrho} \varphi^{W}_j\varphi^{\theta}_i + \int_{\Omega} \gamma \frac{\theta}{\varrho}\frac{\varphi^{W}_j}{\partial z}\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta}{\varrho^2}\frac{\partial \varrho}{\partial z}\varphi^{W}_j\varphi^{\theta}_i." /></p>
</div><div class="math">
<p><img src="../../images/math/6d4dd9f4fd2bbd38d45aace759dd9c4cf2954b81.png" alt="\frac{\partial F^{\theta}_i}{\partial y^{\theta}_j} =  \int_{\Omega} \frac{1}{\tau} \varphi^{\theta}_j\varphi^{\theta}_i + \int_{\Omega} \frac{U}{\varrho}\frac{\varphi^{\theta}_j}{\partial x}\varphi^{\theta}_i + \int_{\Omega} \frac{W}{\varrho}\frac{\varphi^{\theta}_j}{\partial z}\varphi^{\theta}_i" /></p>
</div><div class="math">
<p><img src="../../images/math/83c8e7530ae6007d591294f6bb9e5d6639571876.png" alt="+ \int_{\Omega} \frac{\gamma}{\varrho} \frac{\partial U}{\partial x} \varphi^{\theta}_j\varphi^{\theta}_i + \int_{\Omega} \frac{\gamma}{\varrho} \frac{\partial W}{\partial z} \varphi^{\theta}_j\varphi^{\theta}_i - \int_{\Omega} \frac{\gamma U}{\varrho^2} \frac{\partial \varrho}{\partial x} \varphi^{\theta}_j\varphi^{\theta}_i - \int_{\Omega} \frac{\gamma W}{\varrho^2} \frac{\partial \varrho}{\partial z} \varphi^{\theta}_j\varphi^{\theta}_i." /></p>
</div></div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Compressible Euler Equations</a><ul>
<li><a class="reference external" href="#dimensionless-euler-equations">Dimensionless Euler Equations</a><ul>
<li><a class="reference external" href="#fem-formulation">FEM Formulation</a></li>
<li><a class="reference external" href="#sea-breeze-modeling">Sea Breeze Modeling</a></li>
</ul>
</li>
<li><a class="reference external" href="#boundary-conditions">Boundary Conditions</a><ul>
<li><a class="reference external" href="#older-notes">Older notes</a></li>
</ul>
</li>
<li><a class="reference external" href="#governing-equations-and-boundary-conditions">Governing Equations and Boundary Conditions</a></li>
<li><a class="reference external" href="#discretization-and-the-newton-s-method">Discretization and the Newton&#8217;s Method</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="mhd.html"
                                  title="previous chapter">MHD Equations</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../quantum/main.html"
                                  title="next chapter">Quantum Field Theory and Quantum Mechanics</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../sources/src/fluid-dynamics/euler.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../quantum/main.html" title="Quantum Field Theory and Quantum Mechanics"
             >next</a> |</li>
        <li class="right" >
          <a href="mhd.html" title="MHD Equations"
             >previous</a> |</li>
        <li><a href="../../index.html">Theoretical Physics Reference v0.1 documentation</a> &raquo;</li>
          <li><a href="main.html" >Fluid Dynamics</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009, OndÅej ÄertÃ­k.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.
    </div>
  </body>
</html>